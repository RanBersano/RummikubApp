<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="RummikubApp.Views.PlayerHandCV"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:ml="clr-namespace:RummikubApp.ModelLogics">

    <!--  9 אריחים רוחב (9*40=360), 2 אריחים גובה (2*55=110)  -->
    <Grid HeightRequest="130" WidthRequest="380">

        <!--  הרקע (הלוח) - תחליף Source לתמונה שלך  -->
        <Border
            HeightRequest="140"
            StrokeShape="RoundRectangle 12"
            StrokeThickness="0"
            WidthRequest="390">

            <Image
                Aspect="Fill"
                HorizontalOptions="Fill"
                Source="boardimg.jpg"
                VerticalOptions="Fill" />
        </Border>

        <!--  היד עצמה  -->
        <CollectionView
            Margin="0"
            HeightRequest="110"
            HorizontalOptions="Center"
            ItemsSource="{Binding Board}"
            VerticalOptions="Center">
            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical" Span="9" />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="ml:Tile">
                    <Border
                        Padding="0"
                        HeightRequest="55"
                        Stroke="DarkTurquoise"
                        StrokeShape="RoundRectangle 8"
                        StrokeThickness="0"
                        WidthRequest="40">

                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding BindingContext.TileTappedCommand, Source={x:Reference HandRoot}}" CommandParameter="{Binding Index}" />
                        </Border.GestureRecognizers>

                        <Border.Triggers>
                            <DataTrigger
                                Binding="{Binding IsSelected}"
                                TargetType="Border"
                                Value="True">
                                <Setter Property="StrokeThickness" Value="2" />
                            </DataTrigger>
                        </Border.Triggers>

                        <Image
                            Aspect="AspectFit"
                            HeightRequest="50"
                            Source="{Binding Source}"
                            WidthRequest="40" />
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!--  רפרנס בשביל BindingContext ב-Tap  -->
        <Grid x:Name="HandRoot" />
    </Grid>
</ContentView>
